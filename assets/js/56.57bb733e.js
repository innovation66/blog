(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{640:function(t,a,s){"use strict";s.r(a);var n=s(5),r=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"内存管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#内存管理"}},[t._v("#")]),t._v(" 内存管理")]),t._v(" "),s("h3",{attrs:{id:"认识内存管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#认识内存管理"}},[t._v("#")]),t._v(" 认识内存管理")]),t._v(" "),s("ul",[s("li",[t._v("不管什么样的编程语言，在代码的执行过程中都是需要给它分配内存的，不同的是某些编程语言需要我们自己手动 的管理内存，某些编程语言会可以自动帮助我们管理内存：")]),t._v(" "),s("li",[t._v("不管以什么样的方式来管理内存，内存的管理都会有如下的生命周期：\n"),s("ul",[s("li",[t._v("第一步：分配申请你需要的内存（申请）；")]),t._v(" "),s("li",[t._v("第二步：使用分配的内存（存放一些东西，比如对象等）；")]),t._v(" "),s("li",[t._v("第三步：不需要使用时，对其进行释放；")])])]),t._v(" "),s("li",[t._v("不同的编程语言对于第一步和第三步会有不同的实现：")]),t._v(" "),s("li",[t._v("手动管理内存：比如 C、C++，包括早期的 OC，都是需要手动来管理内存的申请和释放的（malloc 和 free 函 数）；")]),t._v(" "),s("li",[t._v("自动管理内存：比如 Java、JavaScript、Python、Swift、Dart 等，它们有自动帮助我们管理内存；")]),t._v(" "),s("li",[t._v("我们可以知道 JavaScript 通常情况下是不需要手动来管理的。")])]),t._v(" "),s("h3",{attrs:{id:"js-的内存管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#js-的内存管理"}},[t._v("#")]),t._v(" JS 的内存管理")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("JavaScript 会在定义变量时为我们分配内存。")])]),t._v(" "),s("li",[s("p",[t._v("但是内存分配方式是一样的吗？")]),t._v(" "),s("ul",[s("li",[t._v("JS 对于基本数据类型内存的分配会在执行时， 直接在栈空间进行分配；")]),t._v(" "),s("li",[t._v("JS 对于复杂数据类型内存的分配会在堆内存 中开辟一块空间，并且将这块空间的指针返 回值变量引用；")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20211218140527439.png",alt:"image-20211218140527439"}})])])]),t._v(" "),s("h2",{attrs:{id:"垃圾回收"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#垃圾回收"}},[t._v("#")]),t._v(" 垃圾回收")]),t._v(" "),s("h3",{attrs:{id:"js-的垃圾回收"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#js-的垃圾回收"}},[t._v("#")]),t._v(" JS 的垃圾回收")]),t._v(" "),s("ul",[s("li",[t._v("因为内存的大小是有限的，所以当内存不再需要的时候，我们需要对其进行释放，以便腾出更多的内存空间。")]),t._v(" "),s("li",[t._v("在手动管理内存的语言中，我们需要通过一些方式自己来释放不再需要的内存，比如 free 函数：\n"),s("ul",[s("li",[t._v("但是这种管理的方式其实非常的低效，影响我们编写逻辑的代码的效率；")]),t._v(" "),s("li",[t._v("并且这种方式对开发者的要求也很高，并且一不小心就会产生内存泄露；")])])]),t._v(" "),s("li",[t._v("所以大部分现代的编程语言都是有自己的垃圾回收机制：\n"),s("ul",[s("li",[t._v("垃圾回收的英文是 Garbage Collection，简称 GC；")]),t._v(" "),s("li",[t._v("对于那些不再使用的对象，我们都称之为是垃圾，它需要被回收，以释放更多的内存空间；")]),t._v(" "),s("li",[t._v("而我们的语言运行环境，比如 Java 的运行环境 JVM，JavaScript 的运行环境 js 引擎都支持内存垃圾回收器；")]),t._v(" "),s("li",[t._v("垃圾回收器我们也会简称为 GC，所以在很多地方你看到 GC 其实指的是垃圾回收器；")])])]),t._v(" "),s("li",[t._v("但是这里又出现了另外一个很关键的问题：GC 怎么知道哪些对象是不再使用的呢？\n"),s("ul",[s("li",[t._v("这里就要用到 GC 的算法了")])])])]),t._v(" "),s("h3",{attrs:{id:"常见-cg-算法-引用计数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见-cg-算法-引用计数"}},[t._v("#")]),t._v(" 常见 CG 算法 - 引用计数")]),t._v(" "),s("ul",[s("li",[t._v("引用计数：")]),t._v(" "),s("li",[t._v("当一个对象有一个引用指向它时，那么这个对象的引用就+1，当一个对象的引用为 0 时，这个对象就可以被销毁掉；")]),t._v(" "),s("li",[t._v("这个算法有一个很大的弊端就是会产生循环引用；")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20211218140741507.png",alt:"image-20211218140741507"}})]),t._v(" "),s("h3",{attrs:{id:"常见-cg-算法-标记清除"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见-cg-算法-标记清除"}},[t._v("#")]),t._v(" 常见 CG 算法 - 标记清除")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("标记清除：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("这个算法是设置一个根对象（root object），垃圾回收器会定期从这个根开始，找所有从根开始有引用到的对象，对 于哪些没有引用到的对象，就认为是不可用的对象；")])]),t._v(" "),s("li",[s("p",[t._v("这个算法可以很好的解决循环引用的问题；")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20211218140838897.png",alt:"image-20211218140838897"}})])])])]),t._v(" "),s("li",[s("p",[t._v("JS 引擎比较广泛的采用的就是标记清除算法，当然类似于 V8 引擎为了进行更好的优化，它在算法的实现细节上也会结合 一些其他的算法。")])])]),t._v(" "),s("h3",{attrs:{id:"常见的-gc-算法-其他算法优化补充"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见的-gc-算法-其他算法优化补充"}},[t._v("#")]),t._v(" 常见的 GC 算法 - 其他算法优化补充")]),t._v(" "),s("ul",[s("li",[t._v("JS 引擎比较广泛的采用的就是可达性中的标记清除算法，当然类似于 V8 引擎为了进行更好的优化，它在算法的实现细节上也会 结合一些其他的算法。")]),t._v(" "),s("li",[t._v("标记整理（Mark-Compact） 和“标记－清除”相似；\n"),s("ul",[s("li",[t._v("不同的是，回收期间同时会将保留的存储对象搬运汇集到连续的内存空间，从而整合空闲空间，避免内存碎片化；")])])]),t._v(" "),s("li",[t._v("分代收集（Generational collection）—— 对象被分成两组：“新的”和“旧的”。\n"),s("ul",[s("li",[t._v("许多对象出现，完成它们的工作并很快死去，它们可以很快被清理；")]),t._v(" "),s("li",[t._v("那些长期存活的对象会变得“老旧”，而且被检查的频次也会减少；")])])]),t._v(" "),s("li",[t._v("增量收集（Incremental collection）\n"),s("ul",[s("li",[t._v("如果有许多对象，并且我们试图一次遍历并标记整个对象集，则可能需要一些时间，并在执行过程中带来明显的延迟。")]),t._v(" "),s("li",[t._v("所以引擎试图将垃圾收集工作分成几部分来做，然后将这几部分会逐一进行处理，这样会有许多微小的延迟而不是一个大的 延迟；")])])]),t._v(" "),s("li",[t._v("闲时收集（Idle-time collection）\n"),s("ul",[s("li",[t._v("垃圾收集器只会在 CPU 空闲时尝试运行，以减少可能对代码执行的影响。")])])])]),t._v(" "),s("h3",{attrs:{id:"v8-引擎详细内存图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#v8-引擎详细内存图"}},[t._v("#")]),t._v(" V8 引擎详细内存图")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("事实上，V8 引擎为了提供内存的管理效率，对内存进行非常详细的划分：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20220531171524000.png",alt:"image-20220531171524000"}})])])]),t._v(" "),s("h2",{attrs:{id:"闭包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#闭包"}},[t._v("#")]),t._v(" 闭包")]),t._v(" "),s("h3",{attrs:{id:"让人迷惑的闭包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#让人迷惑的闭包"}},[t._v("#")]),t._v(" 让人迷惑的闭包")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("闭包是 JavaScript 中一个非常容易让人迷惑的知识点：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("这几天看到有同学在深入 JS 高级的交流群中发了这么一张图片；")])]),t._v(" "),s("li",[s("p",[t._v("并且闭包也是群里面大家讨论最多的一个话题；")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20211220085951947.png",alt:"image-20211220085951947"}})]),t._v(" "),s("ul",[s("li",[t._v("《你不知道的 JavaScript》")])])])])]),t._v(" "),s("li",[s("p",[t._v("闭包确实是 JavaScript 中一个很难理解的知识点，接下来我们就对其一步步来进行剖析，看看它到底有什么神奇之 处。")])])]),t._v(" "),s("h3",{attrs:{id:"js-中函数是一等公民"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#js-中函数是一等公民"}},[t._v("#")]),t._v(" JS 中函数是一等公民")]),t._v(" "),s("ul",[s("li",[t._v("在 JavaScript 中，函数是非常重要的，并且是一等公民：")]),t._v(" "),s("li",[t._v("那么就意味着函数的使用是非常灵活的；")]),t._v(" "),s("li",[t._v("函数可以作为另外一个函数的参数，也可以作为另外一个函数的返回值来使用；")]),t._v(" "),s("li",[t._v("自己编写高阶函数")]),t._v(" "),s("li",[t._v("使用内置的高阶函数")]),t._v(" "),s("li",[t._v("高阶函数:\n"),s("ul",[s("li",[t._v("把一个函数如果接受另外一个函数作为参数,或者该函数会返回另外一个函数作为返回值的函数, 那么这个函数就称之为是一个高阶函数")])])])]),t._v(" "),s("h3",{attrs:{id:"闭包的定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#闭包的定义"}},[t._v("#")]),t._v(" 闭包的定义")]),t._v(" "),s("ul",[s("li",[t._v("这里先来看一下闭包的定义，分成两个：在计算机科学中和在 JavaScript 中。")]),t._v(" "),s("li",[t._v("在计算机科学中对闭包的定义（维基百科）：\n"),s("ul",[s("li",[t._v("闭包（英语：Closure），又称词法闭包（Lexical Closure）或函数闭包（function closures）；")]),t._v(" "),s("li",[t._v("是在支持 "),s("strong",[t._v("头等函数")]),t._v(" 的编程语言中，实现词法绑定的一种技术； (函数是第一公民的语言)")]),t._v(" "),s("li",[t._v("闭包在实现上是一个结构体，它存储了一个函数和一个关联的环境（相当于一个符号查找表）；")]),t._v(" "),s("li",[t._v("闭包跟函数最大的区别在于，当捕捉闭包的时候，它的 自由变量 会在捕捉时被确定，这样即使脱离了捕捉时的上下文，它也能照常运行；")])])]),t._v(" "),s("li",[t._v("闭包的概念出现于 60 年代，最早实现闭包的程序是 Scheme，那么我们就可以理解为什么 JavaScript 中有闭包：\n"),s("ul",[s("li",[t._v("因为 JavaScript 中有大量的设计是来源于 Scheme 的；")])])]),t._v(" "),s("li",[t._v("我们再来看一下 MDN 对 JavaScript 闭包的解释：\n"),s("ul",[s("li",[t._v("一个函数和对其周围状态（lexical environment，词法环境）的引用捆绑在一起（或者说函数被引用包围），这样的组合就是闭包（closure）；")]),t._v(" "),s("li",[t._v("也就是说，闭包让你可以在一个内层函数中访问到其外层函数的作用域；")]),t._v(" "),s("li",[t._v("在 JavaScript 中，每当创建一个函数，闭包就会在函数创建的同时被创建出来；")])])]),t._v(" "),s("li",[t._v("那么我的理解和总结：\n"),s("ul",[s("li",[t._v("一个普通的函数 function，如果它可以访问外层作用于的自由变量，那么这个函数就是一个闭包；")]),t._v(" "),s("li",[t._v("从广义的角度来说：JavaScript 中的函数都是闭包；")]),t._v(" "),s("li",[t._v("从狭义的角度来说：JavaScript 中一个函数，如果访问了外层作用域的变量，那么它是一个闭包；")])])])]),t._v(" "),s("h3",{attrs:{id:"闭包的访问过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#闭包的访问过程"}},[t._v("#")]),t._v(" 闭包的访问过程")]),t._v(" "),s("ul",[s("li",[t._v("如果我们编写了如下的代码，它一定是形成了闭包的：")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeAdder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("num")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" add9 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeAdder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20211218141332376.png",alt:"image-20211218141332376"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20220531174111412.png",alt:"image-20220531174111412"}})]),t._v(" "),s("h3",{attrs:{id:"闭包的执行过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#闭包的执行过程"}},[t._v("#")]),t._v(" 闭包的执行过程")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("那么函数继续执行呢？")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("这个时候 makeAdder 函数执行完毕，正常情况下我们的 AO 对象会被释放；")])]),t._v(" "),s("li",[s("p",[t._v("但是因为在 0xb00 的函数中有作用域引用指向了这个 AO 对象，所以它不会被释放掉；")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20211218141417496.png",alt:"image-20211218141417496"}})])])])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20220531175355840.png",alt:"image-20220531175355840"}})]),t._v(" "),s("h3",{attrs:{id:"闭包的内存泄露"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#闭包的内存泄露"}},[t._v("#")]),t._v(" 闭包的内存泄露")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("那么我们为什么经常会说闭包是有内存泄露的呢？")]),t._v(" "),s("ul",[s("li",[t._v("在上面的案例中，如果后续我们不再使用 add9 函数了，那么该函数对象应该要被销毁掉，并且其引用着的父作用域 AO 也应该被销毁掉；")]),t._v(" "),s("li",[t._v("但是目前因为在全局作用域下 add9 变量对 0xb00 的函数对象有引用，而 0xb00 的作用域中 AO（0x200）有引用，所以最终会造成这些内存都是无法被释放的；")]),t._v(" "),s("li",[t._v("所以我们经常说的闭包会造成内存泄露，其实就是刚才的引用链中的所有对象都是无法释放的；")])])]),t._v(" "),s("li",[s("p",[t._v("那么，怎么解决这个问题呢？")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("因为当将 add9 设置为 null 时，就不再对函数对象 0xb00 有引用，那么对应的 AO 对象 0x200 也就不可达了；")])]),t._v(" "),s("li",[s("p",[t._v("在 GC 的下一次检测中，它们就会被销毁掉；")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("add9 = null\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])])])])])]),t._v(" "),s("h3",{attrs:{id:"闭包的内存泄漏测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#闭包的内存泄漏测试"}},[t._v("#")]),t._v(" 闭包的内存泄漏测试")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createFnArray")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// var arr = [1, 1, 1, 1, 1, 1, 1, 1,1, 1,1, 1,1 ]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 占据的空间是4M x 100 + 其他的内存 = 400M+")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1 -> number -> 8byte -> 8M")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// js: 10 3.14 -> number -> 8byte ? js引擎")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 8byte => 2的64次方 => 4byte")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 小的数字类型, 在v8中成为Sim, 小数字 2的32次方")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" arr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fill")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// var arrayFn = createFnArray()")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// arrayFn = null")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 100 * 100 = 10000 = 10s")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" arrayFns "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    arrayFns"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createFnArray")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// arrayFns = null")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      arrayFns"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pop")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20211218141649469.png",alt:"image-20211218141649469"}}),s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20220531180235543.png",alt:"image-20220531180235543"}})]),t._v(" "),s("h2",{attrs:{id:"ao-不使用的属性-闭包中有些不使用的变量会不会销毁"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ao-不使用的属性-闭包中有些不使用的变量会不会销毁"}},[t._v("#")]),t._v(" AO 不使用的属性（闭包中有些不使用的变量会不会销毁）")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("我们来研究一个问题：AO 对象不会被销毁时，是否里面的所有属性都不会被释放？")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("下面这段代码中 name 属于闭包的父作用域里面的变量；")])]),t._v(" "),s("li",[s("p",[t._v("我们知道形成闭包之后 count 一定不会被销毁掉，那么 name 是否会被销毁掉呢？")])]),t._v(" "),s("li",[s("p",[t._v("这里我打上了断点，我们可以在浏览器上看看结果；")])]),t._v(" "),s("li",[s("p",[t._v("name 会被销毁因为没有东西引用它了")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("markAdder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mjjh"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" height "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.88"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("num")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("debugger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"height"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" height"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" add9 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("markAdder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/innovation66/picgo/main/image-20220626144806541.png",alt:"image-20220626144806541"}})])])])])])])}),[],!1,null,null,null);a.default=r.exports}}]);